# CLOUD9.2 TELJES DEPLOY GUIDE
# 1Ô∏è‚É£ HETZNER VPS BE√ÅLL√çT√ÅS
# 1.1 VPS l√©trehoz√°s

# Hetzner Cloud:

# Ubuntu 24.04

# 4GB RAM minimum

# Public IPv4

# 1.2 SSH bel√©p√©s

# Mac:

# ssh root@SERVER_IP

# 1.3 Docker telep√≠t√©s
# apt update && apt upgrade -y

# curl -fsSL https://get.docker.com | sh

# apt install docker-compose-plugin -y

# docker --version
# docker compose version

# 2Ô∏è‚É£ PROJEKT STRUKT√öRA A VPS-EN
# mkdir -p /srv/cloud9
# cd /srv/cloud9

# 3Ô∏è‚É£ GITHUB INTEGR√ÅCI√ì
# 3.1 Repository l√©trehoz√°sa GitHubon

# private repo

# Cloud9.2

# 3.2 Mac-en felt√∂lt√©s
# git init
# git remote add origin https://github.com/USERNAME/cloud9.git
# git add .
# git commit -m "Initial version"
# git push -u origin main

# 3.3 VPS-en kl√≥noz√°s
# cd /srv/cloud9
# git clone https://github.com/USERNAME/cloud9.git src
# cd src

# 4Ô∏è‚É£ DOCKER COMPOSE (PRODUCTION READY)

# /srv/cloud9/src/docker-compose.yml

# services:
#   sqlserver:
#     image: mcr.microsoft.com/mssql/server:2019-latest
#     environment:
#       ACCEPT_EULA: "Y"
#       MSSQL_SA_PASSWORD: "${MSSQL_SA_PASSWORD}"
#       MSSQL_PID: "Express"
#     volumes:
#       - mssql_data:/var/opt/mssql
#     networks:
#       - app-network
#     restart: unless-stopped

#   app:
#     build:
#       context: .
#       dockerfile: dockerfile
#     ports:
#       - "8080:8080"
#     environment:
#       ASPNETCORE_ENVIRONMENT: "Production"
#       ASPNETCORE_URLS: "http://+:8080"
#       ConnectionStrings__DefaultConnection: "Server=sqlserver,1433;Database=Cloud9_Nyugalom;User Id=sa;Password=${MSSQL_SA_PASSWORD};TrustServerCertificate=True;"
#     volumes:
#       - dpkeys:/var/dpkeys
#       - taskdocs:/data/taskdocs
#     depends_on:
#       - sqlserver
#     networks:
#       - app-network
#     restart: unless-stopped

# networks:
#   app-network:
#     driver: bridge

# volumes:
#   mssql_data:
#   taskdocs:
#   dpkeys:

# 5Ô∏è‚É£ .ENV F√ÅJL (NE TEGYED GITHUBRA)

# /srv/cloud9/src/.env

# MSSQL_SA_PASSWORD=StrongPasswordHere


# .gitignore-ba:

# .env

# 6Ô∏è‚É£ ELS≈ê IND√çT√ÅS
# cd /srv/cloud9/src
# docker compose up -d --build


# App:

# http://SERVER_IP:8080

# 7Ô∏è‚É£ PORTAINER TELEP√çT√âS (INGYENES)
# 7.1 VPS-en
# docker volume create portainer_data

# docker run -d \
#   -p 9000:9000 \
#   --name portainer \
#   --restart=always \
#   -v /var/run/docker.sock:/var/run/docker.sock \
#   -v portainer_data:/data \
#   portainer/portainer-ce:latest


# B√∂ng√©sz≈ë:

# http://SERVER_IP:9000


# Admin user l√©trehoz√°s.

# 8Ô∏è‚É£ HETZNER HOZZ√ÅAD√ÅSA MAC-ES PORTAINERHEZ (OPTIONAL)

# VPS-en:

# docker run -d \
#   -p 9001:9001 \
#   --name portainer_agent \
#   --restart=always \
#   -v /var/run/docker.sock:/var/run/docker.sock \
#   -v /var/lib/docker/volumes:/var/lib/docker/volumes \
#   -v /:/host \
#   portainer/agent


# Mac Portainer ‚Üí
# Environment ‚Üí Agent ‚Üí SERVER_IP:9001

# 9Ô∏è‚É£ VERZI√ì KIAD√ÅSI WORKFLOW (EGYSZER≈∞ MODELL)
# üîπ Fejleszt√©s Mac-en
# git add .
# git commit -m "New feature"
# git push

# üîπ VPS-en
# cd /srv/cloud9/src
# git pull

# üîπ Portainerben

# Hetzner ‚Üí Stacks ‚Üí src ‚Üí Deploy

# K√©sz.

# üîü PROFIBB RELEASE (IMAGE ALAP√ö)
# 10.1 Mac-en build
# docker build -t username/cloud9:1.0.1 .
# docker push username/cloud9:1.0.1

# 10.2 Compose m√≥dos√≠t√°s
# app:
#   image: username/cloud9:1.0.1

# 10.3 Portainer ‚Üí Pull image ‚Üí Deploy

# Nincs t√∂bb SSH.

# 1Ô∏è‚É£1Ô∏è‚É£ ROLLBACK

# Ha gond van:

# Compose-ban vissza:

# image: username/cloud9:1.0.0


# Deploy.

# 1Ô∏è‚É£2Ô∏è‚É£ DB BACKUP MINDEN RELEASE EL≈êTT
# docker run --rm -it --network src_app-network mcr.microsoft.com/mssql-tools \
# /opt/mssql-tools/bin/sqlcmd \
# -S src-sqlserver-1 \
# -U sa \
# -P "$MSSQL_SA_PASSWORD" \
# -Q "
# BACKUP DATABASE [Cloud9_Nyugalom]
# TO DISK='/var/opt/mssql/backup/Cloud9_$(date +%F_%H%M).bak'
# WITH INIT, COMPRESSION"

# 1Ô∏è‚É£3Ô∏è‚É£ AJ√ÅNLOTT K√ñVETKEZ≈ê L√âP√âSEK

# Production szinthez:

# Nginx reverse proxy

# HTTPS (Let's Encrypt)

# Port 9000 lez√°r√°sa

# Firewall IP whitelist

# Automatikus nightly backup

# Healthcheck endpoint

# üéØ √ñSSZEFOGLAL√ÅS

# Most m√°r van:

# ‚úî Hetzner VPS
# ‚úî Docker
# ‚úî MSSQL container
# ‚úî ASP.NET container
# ‚úî GitHub workflow
# ‚úî Portainer GUI
# ‚úî Verzi√≥ kiad√°s
# ‚úî Rollback
# ‚úî Backup

# Ha szeretn√©d, k√∂vetkez≈ë szintre emelj√ºk:

# üîí Production security hardening

# üîÑ CI/CD GitHub Actions auto deploy

# üåç Domain + HTTPS

# üì¶ Zero-downtime deploy