@page
@using Cloud9_2.Models
@model Cloud9_2.Pages.DocManagement.Doc.IndexModel
@using System.Globalization

@{
    Layout = "_Layout";
    ViewData["Title"] = "Dokumentumok";
}

@await Html.PartialAsync("_DocManSidebar")

<div class="right-content">
    <div class="page-header-fixed-top">

        <!-- Breadcrumb -->
        <div class="d-flex justify-content-between align-items-center mb-2">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb bg-body-tertiary rounded-3 p-2 mb-0">
                    <li class="breadcrumb-item"><a href="../../">Főoldal</a></li>
                    <li class="breadcrumb-item"><a href="../">CRM Dashboard</a></li>
                    <li class="breadcrumb-item active">Dokumentumok</li>
                </ol>
            </nav>
        </div>

        <!-- Header actions -->
        <div class="d-flex justify-content-between align-items-center mb-3">
            <div class="d-flex align-items-center gap-2">
                <button class="btn btn-outline-primary"
                        data-bs-toggle="modal"
                        data-bs-target="#createDocumentModal">
                    + Új Dokumentum
                </button>
                <button class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#docFilterModal">
                <i class="bi bi-funnel me-2"></i>Szűrő
                </button>

            </div>

            <div class="d-flex align-items-center gap-2">
                <form method="get" asp-page="./Index"
                      class="input-group input-group-sm"
                      style="width: 250px;">
                    <input type="text"
                           class="form-control"
                           placeholder="Dokumentumok keresése..."
                           name="SearchTerm"
                           value="@Model.SearchTerm">
                    <input type="hidden" name="PageSize" value="@Model.PageSize" />
                    <button class="btn btn-outline-secondary" type="submit">
                        <i class="bi bi-search"></i>
                    </button>
                </form>

                <div class="dropdown">
                    <button class="btn btn-outline-secondary btn-sm dropdown-toggle"
                            type="button"
                            data-bs-toggle="dropdown">
                        <i class="bi bi-funnel me-1"></i>Rendezés / Szűrés
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="?SortBy=uploaddate">Legújabb elöl</a></li>
                        <li><a class="dropdown-item" href="?SortBy=documentid">Dokumentum ID</a></li>
                        <li><a class="dropdown-item" href="?SortBy=filename">Fájlnév</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="?StatusFilter=Beérkezett">Beérkezett</a></li>
                        <li><a class="dropdown-item" href="?StatusFilter=Függőben">Függőben</a></li>
                        <li><a class="dropdown-item" href="?StatusFilter=Elfogadott">Elfogadott</a></li>
                        <li><a class="dropdown-item" href="?StatusFilter=Lezárt">Lezárt</a></li>
                        <li><a class="dropdown-item" href="?StatusFilter=Jóváhagyandó">Jóváhagyandó</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- TABLE -->
        <div class="table-dynamic-height" data-page-size="@Model.PageSize">
            <table class="table table-striped table-hover mb-0">
                <thead class="sticky-top custom-thead table-blur">
                    <tr>
                        <th>Dokumentum ID</th>
                        <th>Fájlnév</th>
                        <th>Partner</th>
                        <th>Dátum</th>
                        <th>Státusz</th>
                        <th class="text-center">Műveletek</th>
                    </tr>
                </thead>

                <!-- JS IDE TÖLT -->
                <tbody id="documentsTableBody">
                    <tr>
                        <td colspan="6" class="text-center py-5 text-muted">
                            Betöltés...
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- LOAD MORE -->
        <div id="loadMoreDocsContainer" class="text-center py-2">
            <button id="loadMoreDocsBtn" class="btn btn-outline-primary btn-sm">
                Több betöltése
            </button>
        </div>

    </div>

    <!-- CREATE / VIEW / EDIT modals -->
    @await Html.PartialAsync("_Modals")



@section Scripts {
    <script src="~/js/Doc/documentFilter.js"></script>
    <script src="/js/Doc/docLoadMore.js"></script>
    <script src="/js/Doc/viewDocument.js"></script>
    <script src="/js/Doc/doc-create.js"></script>
    <script src="/js/Doc/editDocument.js"></script>
    <script src="/js/Doc/documentHistory.js"></script>
}

</div>
